---
// src/components/LoopComponents/CircleImageItem/CircleImageItem.astro
import CircleImageWrapper from "./CircleImageWrapper.jsx";
import { Image } from "astro:assets";
import { getItemKey } from "@/utils/getItemKey.js";
import ImageFallback from "@/assets/background.svg";

const { item, itemClass = "", collectionName, HasPage } = Astro.props;
const effectiveHasPage = item.data.hasPage ?? HasPage;
const href = effectiveHasPage
  ? `/${collectionName}/${getItemKey(item)}`
  : null;
const alt = item.data.title || "";

// `item.data.featuredImage` is already an Asset object
const imgAsset = item.data.featuredImage ?? ImageFallback;
---
<CircleImageWrapper
  client:load
  href={href}
  ariaLabel={href ? `View details for ${alt}` : null}
  itemClass={itemClass}
>
  <Image
    src={imgAsset}
    alt={alt}
    widths={[56]}
    formats={["avif", "webp", "jpeg"]}
    placeholder="blur"
    class="object-cover w-full h-full"
    loading="eager"
    fetchpriority="high"
  />
</CircleImageWrapper>
