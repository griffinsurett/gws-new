---
// src/components/ContentRenderer/variants/BenefitsInlineVariant.astro
import type { BaseVariantProps } from "../ContentRenderer.types";
import type { FeatureCardData } from "@/components/LoopComponents/FeatureCard";
import SectionHeader from "@/components/SectionHeader.astro";
import CardRenderer from "@/components/LoopTemplates/CardRenderer.astro";
import { toArray } from "@/utils/array";
import type { HeadingContent } from "@/content/schema";

interface Props extends BaseVariantProps {
  columns?: 1 | 2 | 3 | 4;
}

const {
  items = [],
  title,
  description,
  className = "",
  columns = 2,
  id,
  collectionTitle,
  heading,
} = Astro.props as Props;

const safeItems = toArray(items) as FeatureCardData[];
const fallbackHeading = title ?? collectionTitle;
const headingSource = heading ?? fallbackHeading;
const isSegmentedHeading =
  typeof headingSource === "object" && headingSource !== null;
const segmentedHeading = isSegmentedHeading ? (headingSource as HeadingContent) : undefined;
const resolvedHeading =
  typeof headingSource === "string"
    ? headingSource
    : segmentedHeading?.text ?? fallbackHeading;
const headingPayload = segmentedHeading ?? resolvedHeading;
const showHeader = Boolean(collectionTitle || title || headingPayload || description);

const featureCardProps = {
  listItemProps: {
    layout: "horizontal" as const,
    alignment: "left" as const,
    className: "gap-5 text-left items-start w-full",
    containerClassName: "text-left space-y-2",
    iconClassName: "icon-large z-10 card-icon-color mr-5 shrink-0",
  },
};
---

<section
  id={id}
  class={`outer-section relative ${className}`.trim()}
>
  <div class="space-y-10">
    {showHeader && (
        <SectionHeader
          title={collectionTitle ?? title}
          heading={headingPayload}
          description={description}
          className="text-center"
          headingClassName="h2 mb-4"
          descriptionClassName="text-lg text-muted max-w-2xl mx-auto"
      />
    )}

    {safeItems.length > 0 && (
      <CardRenderer
        items={safeItems}
        columns={columns}
        featureCardProps={featureCardProps}
      />
    )}
  </div>
</section>
