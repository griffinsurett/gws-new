---
// src/pages/index.astro
import { getImage } from "astro:assets";
import BaseLayout from "@/layouts/BaseLayout.astro";
import ContentRenderer from "@/components/ContentRenderer/ContentRenderer.astro";
import {
  query,
  sortByOrder,
} from "@/utils/query";
import FrontPageHero from "@/layouts/FrontPageHero.astro";
import { siteData } from "@/content/siteData";
import { roots } from "@/utils/query/snippets";
import CTASection from "@/layouts/CTASection.astro";
import Video from "@/components/Video/Video.astro";

const heroHeading = {
  before: "Launch a website that works.",
  text: "Fast, secure, growth-ready.",
  after: "",
};

const heroDescription =
  "We're a US-based web development company creating fast, engaging websites built to grow your business. We handle hosting, maintenance, and security â€” and provide full SEO services to help you get found and stay ahead.";

---

<BaseLayout title="Home" description={siteData.description}>
  <main class="flex-1">
    <!-- Hero ContentRenderer with static content -->
    <FrontPageHero
      heading={heroHeading}
      description={heroDescription}
      primaryCTA={{
        text: "Get Started",
        link: "/contact-us",
      }}
    />
   
    <ContentRenderer
      query={roots("capabilities").orderBy(sortByOrder()).limit(6)}
      variant="CardVariant"
      title="Website Services"
      heading={{
        before: "Websites aren't just something we do.",
        text: "They're our specialty.",
      }}
      description="You deserve a lightning-fast, secure, and scalable website that turn your visitors into customers. Every site we build is built to dominate and stand the test of time."
      columns={3}
      gap="lg"
      showButtonSection={false}
      className="pt-35 lg:pt-20"
    />

    <!-- Website Benefits -->
    <ContentRenderer
      query={query("benefits").orderBy(sortByOrder())}
      variant="ListCardVariant"
      title="Why Choose Us"
      heading={{
        before: "What Makes",
        text: "Our Websites Different",
      }}
    />

    <!-- About Us Two-Column Section -->
    <ContentRenderer
      query={query("about-us").orderBy(sortByOrder())}
      variant="TwoColumnImageVariant"
      imagePosition="right"
      imagePlaceholder="ðŸ‘¨â€ðŸ’»"
      imageAlt="Griffin Surett - Founder"
      contentType="text"
      borderClass=""
    >
      <Video
        src="/speed-site.mov"
        alt="Speed site walkthrough"
        class="h-full w-full"
        aspectClass="h-full w-full"
        videoClass="block w-full h-full max-w-full object-cover"
        muted
        loop
        controls
        playsInline
      />
    </ContentRenderer>

    <!-- <ContentRenderer query={query("projects")} variant="PortfolioVariant" /> -->

    <ContentRenderer
      query={query("solutions")}
      variant="IconListVariant"
      heading={{
        before: "Premium Websites for",
        text: "Any Business,",
        after: "Built for Your Growth",
      }}
      title="Website Services"
      description="We design top-tier websites for businesses in every industry â€” from local services to global brands. Every site is custom-built for your goals, lightning-fast, secure, and easy to manage. No templates, no bloat â€” just a powerful online presence that looks sharp, performs flawlessly, and grows with you."
      autoAdvanceDelay={2000}
    />

    <!-- Testimonials with rating filter -->
    <ContentRenderer
      query={query("testimonials").where((entry) => entry.data.rating >= 4)}
      variant="TestimonialCarouselVariant"
    />

       <!-- Portfolio with sorting -->
    <ContentRenderer
      query={query("projects")
        .orderBy(sortByOrder("publishDate", "desc"))}
      variant="PortfolioVariant"
    />

    <!-- Technologies -->
    <ContentRenderer
      query={query("technologies").orderBy(sortByOrder())}
      variant="TechnologiesVariant"
    />

    <!-- Filtered query - still gets meta from authors -->
    <!-- <ContentRenderer
      query={query("authors").where(whereArrayContains("tags", "featured"))}
      variant="CardVariant"
      columns={3}
      gap="lg"
    /> -->

    <!-- Addon Capabilities - auto-populates from capabilities meta -->
    <!-- <ContentRenderer
      query={query("capabilities").orderBy(sortByOrder())}
      variant="CardVariant"
      columns={3}
      gap="lg"
    /> -->

    <!-- FAQ ContentRenderer -->
    <ContentRenderer
      query={query("faq").orderBy(sortByOrder())}
      variant="AccordionVariant"
      allowMultiple={false}
      title="FAQs"
    />

    <CTASection
      title="Get Started"
      heading={{
        before: "Ready to Transform Your Online Presence into a ",
        text: "High-Performance Growth Engine?",
      }}
      description="Join hundreds of successful businesses who trust Griffin's Web Services. While others juggle dozens of services, we've mastered one: building lightning-fast, secure, and scalable sites that turn visitors into customers."
    />

    <!-- Contact ContentRenderer -->
    <!-- <ContentRenderer
      query={query("contact-us")}
      variant="ContactVariant"
      columns={2}
    /> -->

    <!-- Blog with limit - auto-populates from blog meta -->
    <!-- <ContentRenderer
      query={query("blog").limit(2)}
      variant="BlogVariant"
      columns={2}
    /> -->

    <!-- Multi-collection query - requires manual title/description -->
    <!-- <ContentRenderer
      query={query(["blog", "projects"]).orderBy(sortByDate()).limit(10)}
      variant="ListVariant"
      title="Recent Updates"
      description="Latest from our blog and portfolio"
    /> -->
  </main>
</BaseLayout>
